<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>部署测试</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 p-8">
    <div class="max-w-md mx-auto bg-white rounded-lg shadow-md p-6">
        <h1 class="text-2xl font-bold mb-4">部署状态测试</h1>

        <div class="space-y-4">
            <button onclick="testServer()" class="w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">
                测试后端连接
            </button>

            <button onclick="testChat()" class="w-full bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600">
                测试聊天功能
            </button>
        </div>

        <div id="result" class="mt-4 p-4 bg-gray-50 rounded min-h-[100px]">
            测试结果将显示在这里...
        </div>
    </div>

    <script>
        const result = document.getElementById('result');

        function updateResult(message) {
            result.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }

        async function testServer() {
            try {
                updateResult('正在测试服务器连接...');
                const response = await fetch('https://jinggangshan-heritage-api.onrender.com/');
                const data = await response.text();
                updateResult('✅ 服务器连接成功: ' + data);
            } catch (error) {
                updateResult('❌ 服务器连接失败: ' + error.message);
            }
        }

        async function testChat() {
            try {
                updateResult('正在测试聊天功能...');
                const response = await fetch('https://jinggangshan-heritage-api.onrender.com/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question: '什么是井冈山非物质文化遗产？' })
                });
                const data = await response.json();
                updateResult('✅ 聊天功能正常: ' + (data.answer ? '获得回答' : '无回答'));
            } catch (error) {
                updateResult('❌ 聊天功能异常: ' + error.message);
            }
        }
    </script>
</body>

</html>